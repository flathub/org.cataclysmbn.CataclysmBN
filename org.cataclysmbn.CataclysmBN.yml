id: "org.cataclysmbn.CataclysmBN"
runtime: "org.freedesktop.Platform"
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
command: cataclysm-bn-tiles
finish-args:
  - --socket=pulseaudio
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc
  - --device=dri

modules:
  - name: cataclysm-bn-tiles
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
        - -DCMAKE_BUILD_TYPE=Release
        - -DCURSES=OFF
        - -DTILES=ON
        - -DSOUND=ON
        - -DLANGUAGES=all
        - -DUSE_XDG_DIR=ON
        - --install-prefix=/app
        - -DTESTS=OFF
        - -DJSON_FORMAT=OFF
    post-install:
      - install -Dm644 ../org.cataclysmbn.CataclysmBN.svg /app/share/icons/hicolor/scalable/apps/org.cataclysmbn.CataclysmBN.svg
      - install -Dm755 ../org.cataclysmbn.CataclysmBN.desktop /app/share/applications/org.cataclysmbn.CataclysmBN.desktop
      - install -Dm644 ../org.cataclysmbn.CataclysmBN.metainfo.xml /app/share/metainfo/org.cataclysmbn.CataclysmBN.metainfo.xml
      - cp -R ../data/lua /app/share/cataclysm-bn/
      - rm -r /app/share/cataclysm-bn/data/
    sources:
      - type: git
        url: https://github.com/cataclysmbnteam/Cataclysm-BN.git
        commit: "a179f9ab552279f395c882d29165b6e588f7d9e9"
      - type: file
        url: https://raw.githubusercontent.com/cataclysmbnteam/Cataclysm-BN/0a7c36e1da6ab298560534a32c6300dc11a70947/data/XDG/org.cataclysmbn.CataclysmBN.metainfo.xml
        sha256: e4d5bab79a6489c7c3ea7e98c0728e95a307ce329fc55752ece14ab19ba3ddc4
      - type: file
        url: https://raw.githubusercontent.com/cataclysmbnteam/Cataclysm-BN/cb3a3769dc76a3cfd730c190a068f329fc8de2e9/data/XDG/org.cataclysmbn.CataclysmBN.desktop
        sha256: ff39b55f5b3d11825a9d725da247f90399651f4f0ba9a11c3bdf3e630dd2c150
      - type: file
        url: https://raw.githubusercontent.com/cataclysmbnteam/Cataclysm-BN/cb3a3769dc76a3cfd730c190a068f329fc8de2e9/data/XDG/org.cataclysmbn.CataclysmBN.svg
        sha256: edf787d97c3f01f114d417879f1f5659df2057272822465c7f2265970a6de961

